{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":47,"index":81}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":82},"end":{"line":3,"column":26,"index":108}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":109},"end":{"line":4,"column":69,"index":178}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuthStore\", {\n    enumerable: true,\n    get: function () {\n      return useAuthStore;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _zustand = require(_dependencyMap[1], \"zustand\");\n  var _expoWebBrowser = require(_dependencyMap[2], \"expo-web-browser\");\n  var WebBrowser = _interopNamespace(_expoWebBrowser);\n  var _axios = require(_dependencyMap[3], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[4], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  const BACKEND_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL;\n  const useAuthStore = (0, _zustand.create)((set, get) => ({\n    user: null,\n    isLoading: true,\n    isAuthenticated: false,\n    setUser: user => set({\n      user,\n      isAuthenticated: !!user\n    }),\n    checkAuth: async () => {\n      try {\n        const response = await axios.default.get(`${BACKEND_URL}/api/auth/me`, {\n          withCredentials: true\n        });\n        set({\n          user: response.data,\n          isAuthenticated: true,\n          isLoading: false\n        });\n      } catch (error) {\n        set({\n          user: null,\n          isAuthenticated: false,\n          isLoading: false\n        });\n      }\n    },\n    login: async () => {\n      try {\n        // REMINDER: DO NOT HARDCODE THE URL, OR ADD ANY FALLBACKS OR REDIRECT URLS, THIS BREAKS THE AUTH\n        const redirectUrl = `${BACKEND_URL}/(tabs)/search`;\n        const authUrl = `https://auth.emergentagent.com/?redirect=${encodeURIComponent(redirectUrl)}`;\n        const result = await WebBrowser.openAuthSessionAsync(authUrl, redirectUrl);\n        if (result.type === 'success' && result.url) {\n          // Extract session_id from URL fragment\n          const url = new URL(result.url);\n          const hash = url.hash.substring(1); // Remove #\n          const params = new URLSearchParams(hash);\n          const sessionId = params.get('session_id');\n          if (sessionId) {\n            // Exchange session_id for user data\n            const response = await axios.default.post(`${BACKEND_URL}/api/auth/session`, {\n              session_id: sessionId\n            }, {\n              withCredentials: true\n            });\n            set({\n              user: response.data,\n              isAuthenticated: true\n            });\n            await AsyncStorage.default.setItem('user', JSON.stringify(response.data));\n          }\n        }\n      } catch (error) {\n        console.error('Login error:', error);\n        throw error;\n      }\n    },\n    logout: async () => {\n      try {\n        await axios.default.post(`${BACKEND_URL}/api/auth/logout`, {}, {\n          withCredentials: true\n        });\n        await AsyncStorage.default.removeItem('user');\n        set({\n          user: null,\n          isAuthenticated: false\n        });\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    }\n  }));\n});","lineCount":114,"map":[[27,2,26,0,"Object"],[27,8,26,0],[27,9,26,0,"defineProperty"],[27,23,26,0],[27,24,26,0,"exports"],[27,31,26,0],[28,4,26,0,"enumerable"],[28,14,26,0],[29,4,26,0,"get"],[29,7,26,0],[29,18,26,0,"get"],[29,19,26,0],[30,6,26,0],[30,13,26,0,"useAuthStore"],[30,25,26,0],[31,4,26,0],[32,2,26,0],[33,2,86,4],[33,6,86,4,"_expoVirtualEnv"],[33,21,86,4],[33,24,86,4,"require"],[33,31,86,4],[33,32,86,4,"_dependencyMap"],[33,46,86,4],[34,2,1,0],[34,6,1,0,"_zustand"],[34,14,1,0],[34,17,1,0,"require"],[34,24,1,0],[34,25,1,0,"_dependencyMap"],[34,39,1,0],[35,2,2,0],[35,6,2,0,"_expoWebBrowser"],[35,21,2,0],[35,24,2,0,"require"],[35,31,2,0],[35,32,2,0,"_dependencyMap"],[35,46,2,0],[36,2,2,0],[36,6,2,0,"WebBrowser"],[36,16,2,0],[36,19,2,0,"_interopNamespace"],[36,36,2,0],[36,37,2,0,"_expoWebBrowser"],[36,52,2,0],[37,2,3,0],[37,6,3,0,"_axios"],[37,12,3,0],[37,15,3,0,"require"],[37,22,3,0],[37,23,3,0,"_dependencyMap"],[37,37,3,0],[38,2,3,0],[38,6,3,0,"axios"],[38,11,3,0],[38,14,3,0,"_interopDefault"],[38,29,3,0],[38,30,3,0,"_axios"],[38,36,3,0],[39,2,4,0],[39,6,4,0,"_reactNativeAsyncStorageAsyncStorage"],[39,42,4,0],[39,45,4,0,"require"],[39,52,4,0],[39,53,4,0,"_dependencyMap"],[39,67,4,0],[40,2,4,0],[40,6,4,0,"AsyncStorage"],[40,18,4,0],[40,21,4,0,"_interopDefault"],[40,36,4,0],[40,37,4,0,"_reactNativeAsyncStorageAsyncStorage"],[40,73,4,0],[41,2,6,0],[41,8,6,6,"BACKEND_URL"],[41,19,6,17],[41,22,6,17,"_expoVirtualEnv"],[41,37,6,17],[41,38,6,17,"env"],[41,41,6,17],[41,42,6,17,"EXPO_PUBLIC_BACKEND_URL"],[41,65,6,55],[42,2,26,7],[42,8,26,13,"useAuthStore"],[42,20,26,25],[42,23,26,28],[42,27,26,28,"create"],[42,35,26,34],[42,36,26,34,"create"],[42,42,26,34],[42,44,26,46],[42,45,26,47,"set"],[42,48,26,50],[42,50,26,52,"get"],[42,53,26,55],[42,59,26,61],[43,4,27,2,"user"],[43,8,27,6],[43,10,27,8],[43,14,27,12],[44,4,28,2,"isLoading"],[44,13,28,11],[44,15,28,13],[44,19,28,17],[45,4,29,2,"isAuthenticated"],[45,19,29,17],[45,21,29,19],[45,26,29,24],[46,4,31,2,"setUser"],[46,11,31,9],[46,13,31,12,"user"],[46,17,31,16],[46,21,31,21,"set"],[46,24,31,24],[46,25,31,25],[47,6,31,27,"user"],[47,10,31,31],[48,6,31,33,"isAuthenticated"],[48,21,31,48],[48,23,31,50],[48,24,31,51],[48,25,31,52,"user"],[49,4,31,57],[49,5,31,58],[49,6,31,59],[50,4,33,2,"checkAuth"],[50,13,33,11],[50,15,33,13],[50,21,33,13,"checkAuth"],[50,22,33,13],[50,27,33,25],[51,6,34,4],[51,10,34,8],[52,8,35,6],[52,14,35,12,"response"],[52,22,35,20],[52,25,35,23],[52,31,35,29,"axios"],[52,36,35,34],[52,37,35,34,"default"],[52,44,35,34],[52,45,35,35,"get"],[52,48,35,38],[52,49,35,39],[52,52,35,42,"BACKEND_URL"],[52,63,35,53],[52,77,35,67],[52,79,35,69],[53,10,36,8,"withCredentials"],[53,25,36,23],[53,27,36,25],[54,8,37,6],[54,9,37,7],[54,10,37,8],[55,8,38,6,"set"],[55,11,38,9],[55,12,38,10],[56,10,38,12,"user"],[56,14,38,16],[56,16,38,18,"response"],[56,24,38,26],[56,25,38,27,"data"],[56,29,38,31],[57,10,38,33,"isAuthenticated"],[57,25,38,48],[57,27,38,50],[57,31,38,54],[58,10,38,56,"isLoading"],[58,19,38,65],[58,21,38,67],[59,8,38,73],[59,9,38,74],[59,10,38,75],[60,6,39,4],[60,7,39,5],[60,8,39,6],[60,15,39,13,"error"],[60,20,39,18],[60,22,39,20],[61,8,40,6,"set"],[61,11,40,9],[61,12,40,10],[62,10,40,12,"user"],[62,14,40,16],[62,16,40,18],[62,20,40,22],[63,10,40,24,"isAuthenticated"],[63,25,40,39],[63,27,40,41],[63,32,40,46],[64,10,40,48,"isLoading"],[64,19,40,57],[64,21,40,59],[65,8,40,65],[65,9,40,66],[65,10,40,67],[66,6,41,4],[67,4,42,2],[67,5,42,3],[68,4,44,2,"login"],[68,9,44,7],[68,11,44,9],[68,17,44,9,"login"],[68,18,44,9],[68,23,44,21],[69,6,45,4],[69,10,45,8],[70,8,46,6],[71,8,47,6],[71,14,47,12,"redirectUrl"],[71,25,47,23],[71,28,47,26],[71,31,47,29,"BACKEND_URL"],[71,42,47,40],[71,58,47,56],[72,8,48,6],[72,14,48,12,"authUrl"],[72,21,48,19],[72,24,48,22],[72,68,48,66,"encodeURIComponent"],[72,86,48,84],[72,87,48,85,"redirectUrl"],[72,98,48,96],[72,99,48,97],[72,101,48,99],[73,8,50,6],[73,14,50,12,"result"],[73,20,50,18],[73,23,50,21],[73,29,50,27,"WebBrowser"],[73,39,50,37],[73,40,50,38,"openAuthSessionAsync"],[73,60,50,58],[73,61,50,59,"authUrl"],[73,68,50,66],[73,70,50,68,"redirectUrl"],[73,81,50,79],[73,82,50,80],[74,8,52,6],[74,12,52,10,"result"],[74,18,52,16],[74,19,52,17,"type"],[74,23,52,21],[74,28,52,26],[74,37,52,35],[74,41,52,39,"result"],[74,47,52,45],[74,48,52,46,"url"],[74,51,52,49],[74,53,52,51],[75,10,53,8],[76,10,54,8],[76,16,54,14,"url"],[76,19,54,17],[76,22,54,20],[76,26,54,24,"URL"],[76,29,54,27],[76,30,54,28,"result"],[76,36,54,34],[76,37,54,35,"url"],[76,40,54,38],[76,41,54,39],[77,10,55,8],[77,16,55,14,"hash"],[77,20,55,18],[77,23,55,21,"url"],[77,26,55,24],[77,27,55,25,"hash"],[77,31,55,29],[77,32,55,30,"substring"],[77,41,55,39],[77,42,55,40],[77,43,55,41],[77,44,55,42],[77,45,55,43],[77,46,55,44],[78,10,56,8],[78,16,56,14,"params"],[78,22,56,20],[78,25,56,23],[78,29,56,27,"URLSearchParams"],[78,44,56,42],[78,45,56,43,"hash"],[78,49,56,47],[78,50,56,48],[79,10,57,8],[79,16,57,14,"sessionId"],[79,25,57,23],[79,28,57,26,"params"],[79,34,57,32],[79,35,57,33,"get"],[79,38,57,36],[79,39,57,37],[79,51,57,49],[79,52,57,50],[80,10,59,8],[80,14,59,12,"sessionId"],[80,23,59,21],[80,25,59,23],[81,12,60,10],[82,12,61,10],[82,18,61,16,"response"],[82,26,61,24],[82,29,61,27],[82,35,61,33,"axios"],[82,40,61,38],[82,41,61,38,"default"],[82,48,61,38],[82,49,61,39,"post"],[82,53,61,43],[82,54,62,12],[82,57,62,15,"BACKEND_URL"],[82,68,62,26],[82,87,62,45],[82,89,63,12],[83,14,63,14,"session_id"],[83,24,63,24],[83,26,63,26,"sessionId"],[84,12,63,36],[84,13,63,37],[84,15,64,12],[85,14,64,14,"withCredentials"],[85,29,64,29],[85,31,64,31],[86,12,64,36],[86,13,65,10],[86,14,65,11],[87,12,67,10,"set"],[87,15,67,13],[87,16,67,14],[88,14,67,16,"user"],[88,18,67,20],[88,20,67,22,"response"],[88,28,67,30],[88,29,67,31,"data"],[88,33,67,35],[89,14,67,37,"isAuthenticated"],[89,29,67,52],[89,31,67,54],[90,12,67,59],[90,13,67,60],[90,14,67,61],[91,12,68,10],[91,18,68,16,"AsyncStorage"],[91,30,68,28],[91,31,68,28,"default"],[91,38,68,28],[91,39,68,29,"setItem"],[91,46,68,36],[91,47,68,37],[91,53,68,43],[91,55,68,45,"JSON"],[91,59,68,49],[91,60,68,50,"stringify"],[91,69,68,59],[91,70,68,60,"response"],[91,78,68,68],[91,79,68,69,"data"],[91,83,68,73],[91,84,68,74],[91,85,68,75],[92,10,69,8],[93,8,70,6],[94,6,71,4],[94,7,71,5],[94,8,71,6],[94,15,71,13,"error"],[94,20,71,18],[94,22,71,20],[95,8,72,6,"console"],[95,15,72,13],[95,16,72,14,"error"],[95,21,72,19],[95,22,72,20],[95,36,72,34],[95,38,72,36,"error"],[95,43,72,41],[95,44,72,42],[96,8,73,6],[96,14,73,12,"error"],[96,19,73,17],[97,6,74,4],[98,4,75,2],[98,5,75,3],[99,4,77,2,"logout"],[99,10,77,8],[99,12,77,10],[99,18,77,10,"logout"],[99,19,77,10],[99,24,77,22],[100,6,78,4],[100,10,78,8],[101,8,79,6],[101,14,79,12,"axios"],[101,19,79,17],[101,20,79,17,"default"],[101,27,79,17],[101,28,79,18,"post"],[101,32,79,22],[101,33,79,23],[101,36,79,26,"BACKEND_URL"],[101,47,79,37],[101,65,79,55],[101,67,79,57],[101,68,79,58],[101,69,79,59],[101,71,79,61],[102,10,79,63,"withCredentials"],[102,25,79,78],[102,27,79,80],[103,8,79,85],[103,9,79,86],[103,10,79,87],[104,8,80,6],[104,14,80,12,"AsyncStorage"],[104,26,80,24],[104,27,80,24,"default"],[104,34,80,24],[104,35,80,25,"removeItem"],[104,45,80,35],[104,46,80,36],[104,52,80,42],[104,53,80,43],[105,8,81,6,"set"],[105,11,81,9],[105,12,81,10],[106,10,81,12,"user"],[106,14,81,16],[106,16,81,18],[106,20,81,22],[107,10,81,24,"isAuthenticated"],[107,25,81,39],[107,27,81,41],[108,8,81,47],[108,9,81,48],[108,10,81,49],[109,6,82,4],[109,7,82,5],[109,8,82,6],[109,15,82,13,"error"],[109,20,82,18],[109,22,82,20],[110,8,83,6,"console"],[110,15,83,13],[110,16,83,14,"error"],[110,21,83,19],[110,22,83,20],[110,37,83,35],[110,39,83,37,"error"],[110,44,83,42],[110,45,83,43],[111,6,84,4],[112,4,85,2],[113,2,86,0],[113,3,86,1],[113,4,86,2],[113,5,86,3],[114,0,86,4],[114,3]],"functionMap":{"names":["<global>","create$argument_0","setUser","checkAuth","login","logout"],"mappings":"AAA;8CCyB;WCK,gDD;aEE;GFS;SGE;GH+B;UIE;GJQ;EDC"},"hasCjsExports":false},"type":"js/module"}]}