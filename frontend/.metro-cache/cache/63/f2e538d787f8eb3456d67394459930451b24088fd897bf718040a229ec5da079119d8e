{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":47,"index":81}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":82},"end":{"line":3,"column":26,"index":108}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":109},"end":{"line":4,"column":69,"index":178}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuthStore\", {\n    enumerable: true,\n    get: function () {\n      return useAuthStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _expoWebBrowser = require(_dependencyMap[1], \"expo-web-browser\");\n  var WebBrowser = _interopNamespace(_expoWebBrowser);\n  var _axios = require(_dependencyMap[2], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[3], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const useAuthStore = (0, _zustand.create)((set, get) => ({\n    user: null,\n    isLoading: true,\n    isAuthenticated: false,\n    setUser: user => set({\n      user,\n      isAuthenticated: !!user\n    }),\n    checkAuth: async () => {\n      try {\n        const response = await axios.default.get(`${BACKEND_URL}/api/auth/me`, {\n          withCredentials: true\n        });\n        set({\n          user: response.data,\n          isAuthenticated: true,\n          isLoading: false\n        });\n      } catch (error) {\n        set({\n          user: null,\n          isAuthenticated: false,\n          isLoading: false\n        });\n      }\n    },\n    login: async () => {\n      try {\n        // REMINDER: DO NOT HARDCODE THE URL, OR ADD ANY FALLBACKS OR REDIRECT URLS, THIS BREAKS THE AUTH\n        const redirectUrl = `${BACKEND_URL}/(tabs)/search`;\n        const authUrl = `https://auth.emergentagent.com/?redirect=${encodeURIComponent(redirectUrl)}`;\n        const result = await WebBrowser.openAuthSessionAsync(authUrl, redirectUrl);\n        if (result.type === 'success' && result.url) {\n          // Extract session_id from URL fragment\n          const url = new URL(result.url);\n          const hash = url.hash.substring(1); // Remove #\n          const params = new URLSearchParams(hash);\n          const sessionId = params.get('session_id');\n          if (sessionId) {\n            // Exchange session_id for user data\n            const response = await axios.default.post(`${BACKEND_URL}/api/auth/session`, {\n              session_id: sessionId\n            }, {\n              withCredentials: true\n            });\n            set({\n              user: response.data,\n              isAuthenticated: true\n            });\n            await AsyncStorage.default.setItem('user', JSON.stringify(response.data));\n          }\n        }\n      } catch (error) {\n        console.error('Login error:', error);\n        throw error;\n      }\n    },\n    logout: async () => {\n      try {\n        await axios.default.post(`${BACKEND_URL}/api/auth/logout`, {}, {\n          withCredentials: true\n        });\n        await AsyncStorage.default.removeItem('user');\n        set({\n          user: null,\n          isAuthenticated: false\n        });\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    }\n  }));\n});","lineCount":113,"map":[[27,2,26,0,"Object"],[27,8,26,0],[27,9,26,0,"defineProperty"],[27,23,26,0],[27,24,26,0,"exports"],[27,31,26,0],[28,4,26,0,"enumerable"],[28,14,26,0],[29,4,26,0,"get"],[29,7,26,0],[29,18,26,0,"get"],[29,19,26,0],[30,6,26,0],[30,13,26,0,"useAuthStore"],[30,25,26,0],[31,4,26,0],[32,2,26,0],[33,2,1,0],[33,6,1,0,"_zustand"],[33,14,1,0],[33,17,1,0,"require"],[33,24,1,0],[33,25,1,0,"_dependencyMap"],[33,39,1,0],[34,2,2,0],[34,6,2,0,"_expoWebBrowser"],[34,21,2,0],[34,24,2,0,"require"],[34,31,2,0],[34,32,2,0,"_dependencyMap"],[34,46,2,0],[35,2,2,0],[35,6,2,0,"WebBrowser"],[35,16,2,0],[35,19,2,0,"_interopNamespace"],[35,36,2,0],[35,37,2,0,"_expoWebBrowser"],[35,52,2,0],[36,2,3,0],[36,6,3,0,"_axios"],[36,12,3,0],[36,15,3,0,"require"],[36,22,3,0],[36,23,3,0,"_dependencyMap"],[36,37,3,0],[37,2,3,0],[37,6,3,0,"axios"],[37,11,3,0],[37,14,3,0,"_interopDefault"],[37,29,3,0],[37,30,3,0,"_axios"],[37,36,3,0],[38,2,4,0],[38,6,4,0,"_reactNativeAsyncStorageAsyncStorage"],[38,42,4,0],[38,45,4,0,"require"],[38,52,4,0],[38,53,4,0,"_dependencyMap"],[38,67,4,0],[39,2,4,0],[39,6,4,0,"AsyncStorage"],[39,18,4,0],[39,21,4,0,"_interopDefault"],[39,36,4,0],[39,37,4,0,"_reactNativeAsyncStorageAsyncStorage"],[39,73,4,0],[40,2,6,0],[40,8,6,6,"BACKEND_URL"],[40,19,6,17],[40,22,6,20,"process"],[40,29,6,27],[40,30,6,28,"env"],[40,33,6,31],[40,34,6,32,"EXPO_PUBLIC_BACKEND_URL"],[40,57,6,55],[41,2,26,7],[41,8,26,13,"useAuthStore"],[41,20,26,25],[41,23,26,28],[41,27,26,28,"create"],[41,35,26,34],[41,36,26,34,"create"],[41,42,26,34],[41,44,26,46],[41,45,26,47,"set"],[41,48,26,50],[41,50,26,52,"get"],[41,53,26,55],[41,59,26,61],[42,4,27,2,"user"],[42,8,27,6],[42,10,27,8],[42,14,27,12],[43,4,28,2,"isLoading"],[43,13,28,11],[43,15,28,13],[43,19,28,17],[44,4,29,2,"isAuthenticated"],[44,19,29,17],[44,21,29,19],[44,26,29,24],[45,4,31,2,"setUser"],[45,11,31,9],[45,13,31,12,"user"],[45,17,31,16],[45,21,31,21,"set"],[45,24,31,24],[45,25,31,25],[46,6,31,27,"user"],[46,10,31,31],[47,6,31,33,"isAuthenticated"],[47,21,31,48],[47,23,31,50],[47,24,31,51],[47,25,31,52,"user"],[48,4,31,57],[48,5,31,58],[48,6,31,59],[49,4,33,2,"checkAuth"],[49,13,33,11],[49,15,33,13],[49,21,33,13,"checkAuth"],[49,22,33,13],[49,27,33,25],[50,6,34,4],[50,10,34,8],[51,8,35,6],[51,14,35,12,"response"],[51,22,35,20],[51,25,35,23],[51,31,35,29,"axios"],[51,36,35,34],[51,37,35,34,"default"],[51,44,35,34],[51,45,35,35,"get"],[51,48,35,38],[51,49,35,39],[51,52,35,42,"BACKEND_URL"],[51,63,35,53],[51,77,35,67],[51,79,35,69],[52,10,36,8,"withCredentials"],[52,25,36,23],[52,27,36,25],[53,8,37,6],[53,9,37,7],[53,10,37,8],[54,8,38,6,"set"],[54,11,38,9],[54,12,38,10],[55,10,38,12,"user"],[55,14,38,16],[55,16,38,18,"response"],[55,24,38,26],[55,25,38,27,"data"],[55,29,38,31],[56,10,38,33,"isAuthenticated"],[56,25,38,48],[56,27,38,50],[56,31,38,54],[57,10,38,56,"isLoading"],[57,19,38,65],[57,21,38,67],[58,8,38,73],[58,9,38,74],[58,10,38,75],[59,6,39,4],[59,7,39,5],[59,8,39,6],[59,15,39,13,"error"],[59,20,39,18],[59,22,39,20],[60,8,40,6,"set"],[60,11,40,9],[60,12,40,10],[61,10,40,12,"user"],[61,14,40,16],[61,16,40,18],[61,20,40,22],[62,10,40,24,"isAuthenticated"],[62,25,40,39],[62,27,40,41],[62,32,40,46],[63,10,40,48,"isLoading"],[63,19,40,57],[63,21,40,59],[64,8,40,65],[64,9,40,66],[64,10,40,67],[65,6,41,4],[66,4,42,2],[66,5,42,3],[67,4,44,2,"login"],[67,9,44,7],[67,11,44,9],[67,17,44,9,"login"],[67,18,44,9],[67,23,44,21],[68,6,45,4],[68,10,45,8],[69,8,46,6],[70,8,47,6],[70,14,47,12,"redirectUrl"],[70,25,47,23],[70,28,47,26],[70,31,47,29,"BACKEND_URL"],[70,42,47,40],[70,58,47,56],[71,8,48,6],[71,14,48,12,"authUrl"],[71,21,48,19],[71,24,48,22],[71,68,48,66,"encodeURIComponent"],[71,86,48,84],[71,87,48,85,"redirectUrl"],[71,98,48,96],[71,99,48,97],[71,101,48,99],[72,8,50,6],[72,14,50,12,"result"],[72,20,50,18],[72,23,50,21],[72,29,50,27,"WebBrowser"],[72,39,50,37],[72,40,50,38,"openAuthSessionAsync"],[72,60,50,58],[72,61,50,59,"authUrl"],[72,68,50,66],[72,70,50,68,"redirectUrl"],[72,81,50,79],[72,82,50,80],[73,8,52,6],[73,12,52,10,"result"],[73,18,52,16],[73,19,52,17,"type"],[73,23,52,21],[73,28,52,26],[73,37,52,35],[73,41,52,39,"result"],[73,47,52,45],[73,48,52,46,"url"],[73,51,52,49],[73,53,52,51],[74,10,53,8],[75,10,54,8],[75,16,54,14,"url"],[75,19,54,17],[75,22,54,20],[75,26,54,24,"URL"],[75,29,54,27],[75,30,54,28,"result"],[75,36,54,34],[75,37,54,35,"url"],[75,40,54,38],[75,41,54,39],[76,10,55,8],[76,16,55,14,"hash"],[76,20,55,18],[76,23,55,21,"url"],[76,26,55,24],[76,27,55,25,"hash"],[76,31,55,29],[76,32,55,30,"substring"],[76,41,55,39],[76,42,55,40],[76,43,55,41],[76,44,55,42],[76,45,55,43],[76,46,55,44],[77,10,56,8],[77,16,56,14,"params"],[77,22,56,20],[77,25,56,23],[77,29,56,27,"URLSearchParams"],[77,44,56,42],[77,45,56,43,"hash"],[77,49,56,47],[77,50,56,48],[78,10,57,8],[78,16,57,14,"sessionId"],[78,25,57,23],[78,28,57,26,"params"],[78,34,57,32],[78,35,57,33,"get"],[78,38,57,36],[78,39,57,37],[78,51,57,49],[78,52,57,50],[79,10,59,8],[79,14,59,12,"sessionId"],[79,23,59,21],[79,25,59,23],[80,12,60,10],[81,12,61,10],[81,18,61,16,"response"],[81,26,61,24],[81,29,61,27],[81,35,61,33,"axios"],[81,40,61,38],[81,41,61,38,"default"],[81,48,61,38],[81,49,61,39,"post"],[81,53,61,43],[81,54,62,12],[81,57,62,15,"BACKEND_URL"],[81,68,62,26],[81,87,62,45],[81,89,63,12],[82,14,63,14,"session_id"],[82,24,63,24],[82,26,63,26,"sessionId"],[83,12,63,36],[83,13,63,37],[83,15,64,12],[84,14,64,14,"withCredentials"],[84,29,64,29],[84,31,64,31],[85,12,64,36],[85,13,65,10],[85,14,65,11],[86,12,67,10,"set"],[86,15,67,13],[86,16,67,14],[87,14,67,16,"user"],[87,18,67,20],[87,20,67,22,"response"],[87,28,67,30],[87,29,67,31,"data"],[87,33,67,35],[88,14,67,37,"isAuthenticated"],[88,29,67,52],[88,31,67,54],[89,12,67,59],[89,13,67,60],[89,14,67,61],[90,12,68,10],[90,18,68,16,"AsyncStorage"],[90,30,68,28],[90,31,68,28,"default"],[90,38,68,28],[90,39,68,29,"setItem"],[90,46,68,36],[90,47,68,37],[90,53,68,43],[90,55,68,45,"JSON"],[90,59,68,49],[90,60,68,50,"stringify"],[90,69,68,59],[90,70,68,60,"response"],[90,78,68,68],[90,79,68,69,"data"],[90,83,68,73],[90,84,68,74],[90,85,68,75],[91,10,69,8],[92,8,70,6],[93,6,71,4],[93,7,71,5],[93,8,71,6],[93,15,71,13,"error"],[93,20,71,18],[93,22,71,20],[94,8,72,6,"console"],[94,15,72,13],[94,16,72,14,"error"],[94,21,72,19],[94,22,72,20],[94,36,72,34],[94,38,72,36,"error"],[94,43,72,41],[94,44,72,42],[95,8,73,6],[95,14,73,12,"error"],[95,19,73,17],[96,6,74,4],[97,4,75,2],[97,5,75,3],[98,4,77,2,"logout"],[98,10,77,8],[98,12,77,10],[98,18,77,10,"logout"],[98,19,77,10],[98,24,77,22],[99,6,78,4],[99,10,78,8],[100,8,79,6],[100,14,79,12,"axios"],[100,19,79,17],[100,20,79,17,"default"],[100,27,79,17],[100,28,79,18,"post"],[100,32,79,22],[100,33,79,23],[100,36,79,26,"BACKEND_URL"],[100,47,79,37],[100,65,79,55],[100,67,79,57],[100,68,79,58],[100,69,79,59],[100,71,79,61],[101,10,79,63,"withCredentials"],[101,25,79,78],[101,27,79,80],[102,8,79,85],[102,9,79,86],[102,10,79,87],[103,8,80,6],[103,14,80,12,"AsyncStorage"],[103,26,80,24],[103,27,80,24,"default"],[103,34,80,24],[103,35,80,25,"removeItem"],[103,45,80,35],[103,46,80,36],[103,52,80,42],[103,53,80,43],[104,8,81,6,"set"],[104,11,81,9],[104,12,81,10],[105,10,81,12,"user"],[105,14,81,16],[105,16,81,18],[105,20,81,22],[106,10,81,24,"isAuthenticated"],[106,25,81,39],[106,27,81,41],[107,8,81,47],[107,9,81,48],[107,10,81,49],[108,6,82,4],[108,7,82,5],[108,8,82,6],[108,15,82,13,"error"],[108,20,82,18],[108,22,82,20],[109,8,83,6,"console"],[109,15,83,13],[109,16,83,14,"error"],[109,21,83,19],[109,22,83,20],[109,37,83,35],[109,39,83,37,"error"],[109,44,83,42],[109,45,83,43],[110,6,84,4],[111,4,85,2],[112,2,86,0],[112,3,86,1],[112,4,86,2],[112,5,86,3],[113,0,86,4],[113,3]],"functionMap":{"names":["<global>","create$argument_0","setUser","checkAuth","login","logout"],"mappings":"AAA;8CCyB;WCK,gDD;aEE;GFS;SGE;GH+B;UIE;GJQ;EDC"},"hasCjsExports":false},"type":"js/module"}]}