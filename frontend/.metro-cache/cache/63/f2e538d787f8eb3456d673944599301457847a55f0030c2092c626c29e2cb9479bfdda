{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":47,"index":81}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":82},"end":{"line":3,"column":26,"index":108}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":109},"end":{"line":4,"column":69,"index":178}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuthStore\", {\n    enumerable: true,\n    get: function () {\n      return useAuthStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _expoWebBrowser = require(_dependencyMap[1], \"expo-web-browser\");\n  var WebBrowser = _interopNamespace(_expoWebBrowser);\n  var _axios = require(_dependencyMap[2], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[3], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const useAuthStore = (0, _zustand.create)((set, get) => ({\n    user: null,\n    isLoading: true,\n    isAuthenticated: false,\n    setUser: user => set({\n      user,\n      isAuthenticated: !!user\n    }),\n    checkAuth: async () => {\n      try {\n        const response = await axios.default.get(`${BACKEND_URL}/api/auth/me`, {\n          withCredentials: true\n        });\n        set({\n          user: response.data,\n          isAuthenticated: true,\n          isLoading: false\n        });\n      } catch (error) {\n        set({\n          user: null,\n          isAuthenticated: false,\n          isLoading: false\n        });\n      }\n    },\n    login: async () => {\n      try {\n        // REMINDER: DO NOT HARDCODE THE URL, OR ADD ANY FALLBACKS OR REDIRECT URLS, THIS BREAKS THE AUTH\n        // For Expo apps, use the BACKEND_URL which is dynamically set per environment\n        const redirectUrl = `${BACKEND_URL}/(tabs)/search`;\n        const authUrl = `https://auth.emergentagent.com/?redirect=${encodeURIComponent(redirectUrl)}`;\n        const result = await WebBrowser.openAuthSessionAsync(authUrl, redirectUrl);\n        if (result.type === 'success' && result.url) {\n          // Extract session_id from URL fragment\n          const url = new URL(result.url);\n          const hash = url.hash.substring(1); // Remove #\n          const params = new URLSearchParams(hash);\n          const sessionId = params.get('session_id');\n          if (sessionId) {\n            // Exchange session_id for user data\n            const response = await axios.default.post(`${BACKEND_URL}/api/auth/session`, {\n              session_id: sessionId\n            }, {\n              withCredentials: true\n            });\n            set({\n              user: response.data,\n              isAuthenticated: true\n            });\n            await AsyncStorage.default.setItem('user', JSON.stringify(response.data));\n          }\n        }\n      } catch (error) {\n        console.error('Login error:', error);\n        throw error;\n      }\n    },\n    logout: async () => {\n      try {\n        await axios.default.post(`${BACKEND_URL}/api/auth/logout`, {}, {\n          withCredentials: true\n        });\n        await AsyncStorage.default.removeItem('user');\n        set({\n          user: null,\n          isAuthenticated: false\n        });\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    }\n  }));\n});","lineCount":114,"map":[[27,2,26,0,"Object"],[27,8,26,0],[27,9,26,0,"defineProperty"],[27,23,26,0],[27,24,26,0,"exports"],[27,31,26,0],[28,4,26,0,"enumerable"],[28,14,26,0],[29,4,26,0,"get"],[29,7,26,0],[29,18,26,0,"get"],[29,19,26,0],[30,6,26,0],[30,13,26,0,"useAuthStore"],[30,25,26,0],[31,4,26,0],[32,2,26,0],[33,2,1,0],[33,6,1,0,"_zustand"],[33,14,1,0],[33,17,1,0,"require"],[33,24,1,0],[33,25,1,0,"_dependencyMap"],[33,39,1,0],[34,2,2,0],[34,6,2,0,"_expoWebBrowser"],[34,21,2,0],[34,24,2,0,"require"],[34,31,2,0],[34,32,2,0,"_dependencyMap"],[34,46,2,0],[35,2,2,0],[35,6,2,0,"WebBrowser"],[35,16,2,0],[35,19,2,0,"_interopNamespace"],[35,36,2,0],[35,37,2,0,"_expoWebBrowser"],[35,52,2,0],[36,2,3,0],[36,6,3,0,"_axios"],[36,12,3,0],[36,15,3,0,"require"],[36,22,3,0],[36,23,3,0,"_dependencyMap"],[36,37,3,0],[37,2,3,0],[37,6,3,0,"axios"],[37,11,3,0],[37,14,3,0,"_interopDefault"],[37,29,3,0],[37,30,3,0,"_axios"],[37,36,3,0],[38,2,4,0],[38,6,4,0,"_reactNativeAsyncStorageAsyncStorage"],[38,42,4,0],[38,45,4,0,"require"],[38,52,4,0],[38,53,4,0,"_dependencyMap"],[38,67,4,0],[39,2,4,0],[39,6,4,0,"AsyncStorage"],[39,18,4,0],[39,21,4,0,"_interopDefault"],[39,36,4,0],[39,37,4,0,"_reactNativeAsyncStorageAsyncStorage"],[39,73,4,0],[40,2,6,0],[40,8,6,6,"BACKEND_URL"],[40,19,6,17],[40,22,6,20,"process"],[40,29,6,27],[40,30,6,28,"env"],[40,33,6,31],[40,34,6,32,"EXPO_PUBLIC_BACKEND_URL"],[40,57,6,55],[41,2,26,7],[41,8,26,13,"useAuthStore"],[41,20,26,25],[41,23,26,28],[41,27,26,28,"create"],[41,35,26,34],[41,36,26,34,"create"],[41,42,26,34],[41,44,26,46],[41,45,26,47,"set"],[41,48,26,50],[41,50,26,52,"get"],[41,53,26,55],[41,59,26,61],[42,4,27,2,"user"],[42,8,27,6],[42,10,27,8],[42,14,27,12],[43,4,28,2,"isLoading"],[43,13,28,11],[43,15,28,13],[43,19,28,17],[44,4,29,2,"isAuthenticated"],[44,19,29,17],[44,21,29,19],[44,26,29,24],[45,4,31,2,"setUser"],[45,11,31,9],[45,13,31,12,"user"],[45,17,31,16],[45,21,31,21,"set"],[45,24,31,24],[45,25,31,25],[46,6,31,27,"user"],[46,10,31,31],[47,6,31,33,"isAuthenticated"],[47,21,31,48],[47,23,31,50],[47,24,31,51],[47,25,31,52,"user"],[48,4,31,57],[48,5,31,58],[48,6,31,59],[49,4,33,2,"checkAuth"],[49,13,33,11],[49,15,33,13],[49,21,33,13,"checkAuth"],[49,22,33,13],[49,27,33,25],[50,6,34,4],[50,10,34,8],[51,8,35,6],[51,14,35,12,"response"],[51,22,35,20],[51,25,35,23],[51,31,35,29,"axios"],[51,36,35,34],[51,37,35,34,"default"],[51,44,35,34],[51,45,35,35,"get"],[51,48,35,38],[51,49,35,39],[51,52,35,42,"BACKEND_URL"],[51,63,35,53],[51,77,35,67],[51,79,35,69],[52,10,36,8,"withCredentials"],[52,25,36,23],[52,27,36,25],[53,8,37,6],[53,9,37,7],[53,10,37,8],[54,8,38,6,"set"],[54,11,38,9],[54,12,38,10],[55,10,38,12,"user"],[55,14,38,16],[55,16,38,18,"response"],[55,24,38,26],[55,25,38,27,"data"],[55,29,38,31],[56,10,38,33,"isAuthenticated"],[56,25,38,48],[56,27,38,50],[56,31,38,54],[57,10,38,56,"isLoading"],[57,19,38,65],[57,21,38,67],[58,8,38,73],[58,9,38,74],[58,10,38,75],[59,6,39,4],[59,7,39,5],[59,8,39,6],[59,15,39,13,"error"],[59,20,39,18],[59,22,39,20],[60,8,40,6,"set"],[60,11,40,9],[60,12,40,10],[61,10,40,12,"user"],[61,14,40,16],[61,16,40,18],[61,20,40,22],[62,10,40,24,"isAuthenticated"],[62,25,40,39],[62,27,40,41],[62,32,40,46],[63,10,40,48,"isLoading"],[63,19,40,57],[63,21,40,59],[64,8,40,65],[64,9,40,66],[64,10,40,67],[65,6,41,4],[66,4,42,2],[66,5,42,3],[67,4,44,2,"login"],[67,9,44,7],[67,11,44,9],[67,17,44,9,"login"],[67,18,44,9],[67,23,44,21],[68,6,45,4],[68,10,45,8],[69,8,46,6],[70,8,47,6],[71,8,48,6],[71,14,48,12,"redirectUrl"],[71,25,48,23],[71,28,48,26],[71,31,48,29,"BACKEND_URL"],[71,42,48,40],[71,58,48,56],[72,8,49,6],[72,14,49,12,"authUrl"],[72,21,49,19],[72,24,49,22],[72,68,49,66,"encodeURIComponent"],[72,86,49,84],[72,87,49,85,"redirectUrl"],[72,98,49,96],[72,99,49,97],[72,101,49,99],[73,8,51,6],[73,14,51,12,"result"],[73,20,51,18],[73,23,51,21],[73,29,51,27,"WebBrowser"],[73,39,51,37],[73,40,51,38,"openAuthSessionAsync"],[73,60,51,58],[73,61,51,59,"authUrl"],[73,68,51,66],[73,70,51,68,"redirectUrl"],[73,81,51,79],[73,82,51,80],[74,8,53,6],[74,12,53,10,"result"],[74,18,53,16],[74,19,53,17,"type"],[74,23,53,21],[74,28,53,26],[74,37,53,35],[74,41,53,39,"result"],[74,47,53,45],[74,48,53,46,"url"],[74,51,53,49],[74,53,53,51],[75,10,54,8],[76,10,55,8],[76,16,55,14,"url"],[76,19,55,17],[76,22,55,20],[76,26,55,24,"URL"],[76,29,55,27],[76,30,55,28,"result"],[76,36,55,34],[76,37,55,35,"url"],[76,40,55,38],[76,41,55,39],[77,10,56,8],[77,16,56,14,"hash"],[77,20,56,18],[77,23,56,21,"url"],[77,26,56,24],[77,27,56,25,"hash"],[77,31,56,29],[77,32,56,30,"substring"],[77,41,56,39],[77,42,56,40],[77,43,56,41],[77,44,56,42],[77,45,56,43],[77,46,56,44],[78,10,57,8],[78,16,57,14,"params"],[78,22,57,20],[78,25,57,23],[78,29,57,27,"URLSearchParams"],[78,44,57,42],[78,45,57,43,"hash"],[78,49,57,47],[78,50,57,48],[79,10,58,8],[79,16,58,14,"sessionId"],[79,25,58,23],[79,28,58,26,"params"],[79,34,58,32],[79,35,58,33,"get"],[79,38,58,36],[79,39,58,37],[79,51,58,49],[79,52,58,50],[80,10,60,8],[80,14,60,12,"sessionId"],[80,23,60,21],[80,25,60,23],[81,12,61,10],[82,12,62,10],[82,18,62,16,"response"],[82,26,62,24],[82,29,62,27],[82,35,62,33,"axios"],[82,40,62,38],[82,41,62,38,"default"],[82,48,62,38],[82,49,62,39,"post"],[82,53,62,43],[82,54,63,12],[82,57,63,15,"BACKEND_URL"],[82,68,63,26],[82,87,63,45],[82,89,64,12],[83,14,64,14,"session_id"],[83,24,64,24],[83,26,64,26,"sessionId"],[84,12,64,36],[84,13,64,37],[84,15,65,12],[85,14,65,14,"withCredentials"],[85,29,65,29],[85,31,65,31],[86,12,65,36],[86,13,66,10],[86,14,66,11],[87,12,68,10,"set"],[87,15,68,13],[87,16,68,14],[88,14,68,16,"user"],[88,18,68,20],[88,20,68,22,"response"],[88,28,68,30],[88,29,68,31,"data"],[88,33,68,35],[89,14,68,37,"isAuthenticated"],[89,29,68,52],[89,31,68,54],[90,12,68,59],[90,13,68,60],[90,14,68,61],[91,12,69,10],[91,18,69,16,"AsyncStorage"],[91,30,69,28],[91,31,69,28,"default"],[91,38,69,28],[91,39,69,29,"setItem"],[91,46,69,36],[91,47,69,37],[91,53,69,43],[91,55,69,45,"JSON"],[91,59,69,49],[91,60,69,50,"stringify"],[91,69,69,59],[91,70,69,60,"response"],[91,78,69,68],[91,79,69,69,"data"],[91,83,69,73],[91,84,69,74],[91,85,69,75],[92,10,70,8],[93,8,71,6],[94,6,72,4],[94,7,72,5],[94,8,72,6],[94,15,72,13,"error"],[94,20,72,18],[94,22,72,20],[95,8,73,6,"console"],[95,15,73,13],[95,16,73,14,"error"],[95,21,73,19],[95,22,73,20],[95,36,73,34],[95,38,73,36,"error"],[95,43,73,41],[95,44,73,42],[96,8,74,6],[96,14,74,12,"error"],[96,19,74,17],[97,6,75,4],[98,4,76,2],[98,5,76,3],[99,4,78,2,"logout"],[99,10,78,8],[99,12,78,10],[99,18,78,10,"logout"],[99,19,78,10],[99,24,78,22],[100,6,79,4],[100,10,79,8],[101,8,80,6],[101,14,80,12,"axios"],[101,19,80,17],[101,20,80,17,"default"],[101,27,80,17],[101,28,80,18,"post"],[101,32,80,22],[101,33,80,23],[101,36,80,26,"BACKEND_URL"],[101,47,80,37],[101,65,80,55],[101,67,80,57],[101,68,80,58],[101,69,80,59],[101,71,80,61],[102,10,80,63,"withCredentials"],[102,25,80,78],[102,27,80,80],[103,8,80,85],[103,9,80,86],[103,10,80,87],[104,8,81,6],[104,14,81,12,"AsyncStorage"],[104,26,81,24],[104,27,81,24,"default"],[104,34,81,24],[104,35,81,25,"removeItem"],[104,45,81,35],[104,46,81,36],[104,52,81,42],[104,53,81,43],[105,8,82,6,"set"],[105,11,82,9],[105,12,82,10],[106,10,82,12,"user"],[106,14,82,16],[106,16,82,18],[106,20,82,22],[107,10,82,24,"isAuthenticated"],[107,25,82,39],[107,27,82,41],[108,8,82,47],[108,9,82,48],[108,10,82,49],[109,6,83,4],[109,7,83,5],[109,8,83,6],[109,15,83,13,"error"],[109,20,83,18],[109,22,83,20],[110,8,84,6,"console"],[110,15,84,13],[110,16,84,14,"error"],[110,21,84,19],[110,22,84,20],[110,37,84,35],[110,39,84,37,"error"],[110,44,84,42],[110,45,84,43],[111,6,85,4],[112,4,86,2],[113,2,87,0],[113,3,87,1],[113,4,87,2],[113,5,87,3],[114,0,87,4],[114,3]],"functionMap":{"names":["<global>","create$argument_0","setUser","checkAuth","login","logout"],"mappings":"AAA;8CCyB;WCK,gDD;aEE;GFS;SGE;GHgC;UIE;GJQ;EDC"},"hasCjsExports":false},"type":"js/module"}]}