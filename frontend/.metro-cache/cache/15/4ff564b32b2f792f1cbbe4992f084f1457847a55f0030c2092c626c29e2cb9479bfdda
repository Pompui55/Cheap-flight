{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":47,"index":81}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":82},"end":{"line":3,"column":26,"index":108}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":109},"end":{"line":4,"column":69,"index":178}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuthStore\", {\n    enumerable: true,\n    get: function () {\n      return useAuthStore;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _zustand = require(_dependencyMap[1], \"zustand\");\n  var _expoWebBrowser = require(_dependencyMap[2], \"expo-web-browser\");\n  var WebBrowser = _interopNamespace(_expoWebBrowser);\n  var _axios = require(_dependencyMap[3], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[4], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  const BACKEND_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL;\n  const useAuthStore = (0, _zustand.create)((set, get) => ({\n    user: null,\n    isLoading: true,\n    isAuthenticated: false,\n    setUser: user => set({\n      user,\n      isAuthenticated: !!user\n    }),\n    checkAuth: async () => {\n      try {\n        const response = await axios.default.get(`${BACKEND_URL}/api/auth/me`, {\n          withCredentials: true\n        });\n        set({\n          user: response.data,\n          isAuthenticated: true,\n          isLoading: false\n        });\n      } catch (error) {\n        set({\n          user: null,\n          isAuthenticated: false,\n          isLoading: false\n        });\n      }\n    },\n    login: async () => {\n      try {\n        // REMINDER: DO NOT HARDCODE THE URL, OR ADD ANY FALLBACKS OR REDIRECT URLS, THIS BREAKS THE AUTH\n        // For Expo apps, use the BACKEND_URL which is dynamically set per environment\n        const redirectUrl = `${BACKEND_URL}/(tabs)/search`;\n        const authUrl = `https://auth.emergentagent.com/?redirect=${encodeURIComponent(redirectUrl)}`;\n        const result = await WebBrowser.openAuthSessionAsync(authUrl, redirectUrl);\n        if (result.type === 'success' && result.url) {\n          // Extract session_id from URL fragment\n          const url = new URL(result.url);\n          const hash = url.hash.substring(1); // Remove #\n          const params = new URLSearchParams(hash);\n          const sessionId = params.get('session_id');\n          if (sessionId) {\n            // Exchange session_id for user data\n            const response = await axios.default.post(`${BACKEND_URL}/api/auth/session`, {\n              session_id: sessionId\n            }, {\n              withCredentials: true\n            });\n            set({\n              user: response.data,\n              isAuthenticated: true\n            });\n            await AsyncStorage.default.setItem('user', JSON.stringify(response.data));\n          }\n        }\n      } catch (error) {\n        console.error('Login error:', error);\n        throw error;\n      }\n    },\n    logout: async () => {\n      try {\n        await axios.default.post(`${BACKEND_URL}/api/auth/logout`, {}, {\n          withCredentials: true\n        });\n        await AsyncStorage.default.removeItem('user');\n        set({\n          user: null,\n          isAuthenticated: false\n        });\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    }\n  }));\n});","lineCount":115,"map":[[27,2,26,0,"Object"],[27,8,26,0],[27,9,26,0,"defineProperty"],[27,23,26,0],[27,24,26,0,"exports"],[27,31,26,0],[28,4,26,0,"enumerable"],[28,14,26,0],[29,4,26,0,"get"],[29,7,26,0],[29,18,26,0,"get"],[29,19,26,0],[30,6,26,0],[30,13,26,0,"useAuthStore"],[30,25,26,0],[31,4,26,0],[32,2,26,0],[33,2,87,4],[33,6,87,4,"_expoVirtualEnv"],[33,21,87,4],[33,24,87,4,"require"],[33,31,87,4],[33,32,87,4,"_dependencyMap"],[33,46,87,4],[34,2,1,0],[34,6,1,0,"_zustand"],[34,14,1,0],[34,17,1,0,"require"],[34,24,1,0],[34,25,1,0,"_dependencyMap"],[34,39,1,0],[35,2,2,0],[35,6,2,0,"_expoWebBrowser"],[35,21,2,0],[35,24,2,0,"require"],[35,31,2,0],[35,32,2,0,"_dependencyMap"],[35,46,2,0],[36,2,2,0],[36,6,2,0,"WebBrowser"],[36,16,2,0],[36,19,2,0,"_interopNamespace"],[36,36,2,0],[36,37,2,0,"_expoWebBrowser"],[36,52,2,0],[37,2,3,0],[37,6,3,0,"_axios"],[37,12,3,0],[37,15,3,0,"require"],[37,22,3,0],[37,23,3,0,"_dependencyMap"],[37,37,3,0],[38,2,3,0],[38,6,3,0,"axios"],[38,11,3,0],[38,14,3,0,"_interopDefault"],[38,29,3,0],[38,30,3,0,"_axios"],[38,36,3,0],[39,2,4,0],[39,6,4,0,"_reactNativeAsyncStorageAsyncStorage"],[39,42,4,0],[39,45,4,0,"require"],[39,52,4,0],[39,53,4,0,"_dependencyMap"],[39,67,4,0],[40,2,4,0],[40,6,4,0,"AsyncStorage"],[40,18,4,0],[40,21,4,0,"_interopDefault"],[40,36,4,0],[40,37,4,0,"_reactNativeAsyncStorageAsyncStorage"],[40,73,4,0],[41,2,6,0],[41,8,6,6,"BACKEND_URL"],[41,19,6,17],[41,22,6,17,"_expoVirtualEnv"],[41,37,6,17],[41,38,6,17,"env"],[41,41,6,17],[41,42,6,17,"EXPO_PUBLIC_BACKEND_URL"],[41,65,6,55],[42,2,26,7],[42,8,26,13,"useAuthStore"],[42,20,26,25],[42,23,26,28],[42,27,26,28,"create"],[42,35,26,34],[42,36,26,34,"create"],[42,42,26,34],[42,44,26,46],[42,45,26,47,"set"],[42,48,26,50],[42,50,26,52,"get"],[42,53,26,55],[42,59,26,61],[43,4,27,2,"user"],[43,8,27,6],[43,10,27,8],[43,14,27,12],[44,4,28,2,"isLoading"],[44,13,28,11],[44,15,28,13],[44,19,28,17],[45,4,29,2,"isAuthenticated"],[45,19,29,17],[45,21,29,19],[45,26,29,24],[46,4,31,2,"setUser"],[46,11,31,9],[46,13,31,12,"user"],[46,17,31,16],[46,21,31,21,"set"],[46,24,31,24],[46,25,31,25],[47,6,31,27,"user"],[47,10,31,31],[48,6,31,33,"isAuthenticated"],[48,21,31,48],[48,23,31,50],[48,24,31,51],[48,25,31,52,"user"],[49,4,31,57],[49,5,31,58],[49,6,31,59],[50,4,33,2,"checkAuth"],[50,13,33,11],[50,15,33,13],[50,21,33,13,"checkAuth"],[50,22,33,13],[50,27,33,25],[51,6,34,4],[51,10,34,8],[52,8,35,6],[52,14,35,12,"response"],[52,22,35,20],[52,25,35,23],[52,31,35,29,"axios"],[52,36,35,34],[52,37,35,34,"default"],[52,44,35,34],[52,45,35,35,"get"],[52,48,35,38],[52,49,35,39],[52,52,35,42,"BACKEND_URL"],[52,63,35,53],[52,77,35,67],[52,79,35,69],[53,10,36,8,"withCredentials"],[53,25,36,23],[53,27,36,25],[54,8,37,6],[54,9,37,7],[54,10,37,8],[55,8,38,6,"set"],[55,11,38,9],[55,12,38,10],[56,10,38,12,"user"],[56,14,38,16],[56,16,38,18,"response"],[56,24,38,26],[56,25,38,27,"data"],[56,29,38,31],[57,10,38,33,"isAuthenticated"],[57,25,38,48],[57,27,38,50],[57,31,38,54],[58,10,38,56,"isLoading"],[58,19,38,65],[58,21,38,67],[59,8,38,73],[59,9,38,74],[59,10,38,75],[60,6,39,4],[60,7,39,5],[60,8,39,6],[60,15,39,13,"error"],[60,20,39,18],[60,22,39,20],[61,8,40,6,"set"],[61,11,40,9],[61,12,40,10],[62,10,40,12,"user"],[62,14,40,16],[62,16,40,18],[62,20,40,22],[63,10,40,24,"isAuthenticated"],[63,25,40,39],[63,27,40,41],[63,32,40,46],[64,10,40,48,"isLoading"],[64,19,40,57],[64,21,40,59],[65,8,40,65],[65,9,40,66],[65,10,40,67],[66,6,41,4],[67,4,42,2],[67,5,42,3],[68,4,44,2,"login"],[68,9,44,7],[68,11,44,9],[68,17,44,9,"login"],[68,18,44,9],[68,23,44,21],[69,6,45,4],[69,10,45,8],[70,8,46,6],[71,8,47,6],[72,8,48,6],[72,14,48,12,"redirectUrl"],[72,25,48,23],[72,28,48,26],[72,31,48,29,"BACKEND_URL"],[72,42,48,40],[72,58,48,56],[73,8,49,6],[73,14,49,12,"authUrl"],[73,21,49,19],[73,24,49,22],[73,68,49,66,"encodeURIComponent"],[73,86,49,84],[73,87,49,85,"redirectUrl"],[73,98,49,96],[73,99,49,97],[73,101,49,99],[74,8,51,6],[74,14,51,12,"result"],[74,20,51,18],[74,23,51,21],[74,29,51,27,"WebBrowser"],[74,39,51,37],[74,40,51,38,"openAuthSessionAsync"],[74,60,51,58],[74,61,51,59,"authUrl"],[74,68,51,66],[74,70,51,68,"redirectUrl"],[74,81,51,79],[74,82,51,80],[75,8,53,6],[75,12,53,10,"result"],[75,18,53,16],[75,19,53,17,"type"],[75,23,53,21],[75,28,53,26],[75,37,53,35],[75,41,53,39,"result"],[75,47,53,45],[75,48,53,46,"url"],[75,51,53,49],[75,53,53,51],[76,10,54,8],[77,10,55,8],[77,16,55,14,"url"],[77,19,55,17],[77,22,55,20],[77,26,55,24,"URL"],[77,29,55,27],[77,30,55,28,"result"],[77,36,55,34],[77,37,55,35,"url"],[77,40,55,38],[77,41,55,39],[78,10,56,8],[78,16,56,14,"hash"],[78,20,56,18],[78,23,56,21,"url"],[78,26,56,24],[78,27,56,25,"hash"],[78,31,56,29],[78,32,56,30,"substring"],[78,41,56,39],[78,42,56,40],[78,43,56,41],[78,44,56,42],[78,45,56,43],[78,46,56,44],[79,10,57,8],[79,16,57,14,"params"],[79,22,57,20],[79,25,57,23],[79,29,57,27,"URLSearchParams"],[79,44,57,42],[79,45,57,43,"hash"],[79,49,57,47],[79,50,57,48],[80,10,58,8],[80,16,58,14,"sessionId"],[80,25,58,23],[80,28,58,26,"params"],[80,34,58,32],[80,35,58,33,"get"],[80,38,58,36],[80,39,58,37],[80,51,58,49],[80,52,58,50],[81,10,60,8],[81,14,60,12,"sessionId"],[81,23,60,21],[81,25,60,23],[82,12,61,10],[83,12,62,10],[83,18,62,16,"response"],[83,26,62,24],[83,29,62,27],[83,35,62,33,"axios"],[83,40,62,38],[83,41,62,38,"default"],[83,48,62,38],[83,49,62,39,"post"],[83,53,62,43],[83,54,63,12],[83,57,63,15,"BACKEND_URL"],[83,68,63,26],[83,87,63,45],[83,89,64,12],[84,14,64,14,"session_id"],[84,24,64,24],[84,26,64,26,"sessionId"],[85,12,64,36],[85,13,64,37],[85,15,65,12],[86,14,65,14,"withCredentials"],[86,29,65,29],[86,31,65,31],[87,12,65,36],[87,13,66,10],[87,14,66,11],[88,12,68,10,"set"],[88,15,68,13],[88,16,68,14],[89,14,68,16,"user"],[89,18,68,20],[89,20,68,22,"response"],[89,28,68,30],[89,29,68,31,"data"],[89,33,68,35],[90,14,68,37,"isAuthenticated"],[90,29,68,52],[90,31,68,54],[91,12,68,59],[91,13,68,60],[91,14,68,61],[92,12,69,10],[92,18,69,16,"AsyncStorage"],[92,30,69,28],[92,31,69,28,"default"],[92,38,69,28],[92,39,69,29,"setItem"],[92,46,69,36],[92,47,69,37],[92,53,69,43],[92,55,69,45,"JSON"],[92,59,69,49],[92,60,69,50,"stringify"],[92,69,69,59],[92,70,69,60,"response"],[92,78,69,68],[92,79,69,69,"data"],[92,83,69,73],[92,84,69,74],[92,85,69,75],[93,10,70,8],[94,8,71,6],[95,6,72,4],[95,7,72,5],[95,8,72,6],[95,15,72,13,"error"],[95,20,72,18],[95,22,72,20],[96,8,73,6,"console"],[96,15,73,13],[96,16,73,14,"error"],[96,21,73,19],[96,22,73,20],[96,36,73,34],[96,38,73,36,"error"],[96,43,73,41],[96,44,73,42],[97,8,74,6],[97,14,74,12,"error"],[97,19,74,17],[98,6,75,4],[99,4,76,2],[99,5,76,3],[100,4,78,2,"logout"],[100,10,78,8],[100,12,78,10],[100,18,78,10,"logout"],[100,19,78,10],[100,24,78,22],[101,6,79,4],[101,10,79,8],[102,8,80,6],[102,14,80,12,"axios"],[102,19,80,17],[102,20,80,17,"default"],[102,27,80,17],[102,28,80,18,"post"],[102,32,80,22],[102,33,80,23],[102,36,80,26,"BACKEND_URL"],[102,47,80,37],[102,65,80,55],[102,67,80,57],[102,68,80,58],[102,69,80,59],[102,71,80,61],[103,10,80,63,"withCredentials"],[103,25,80,78],[103,27,80,80],[104,8,80,85],[104,9,80,86],[104,10,80,87],[105,8,81,6],[105,14,81,12,"AsyncStorage"],[105,26,81,24],[105,27,81,24,"default"],[105,34,81,24],[105,35,81,25,"removeItem"],[105,45,81,35],[105,46,81,36],[105,52,81,42],[105,53,81,43],[106,8,82,6,"set"],[106,11,82,9],[106,12,82,10],[107,10,82,12,"user"],[107,14,82,16],[107,16,82,18],[107,20,82,22],[108,10,82,24,"isAuthenticated"],[108,25,82,39],[108,27,82,41],[109,8,82,47],[109,9,82,48],[109,10,82,49],[110,6,83,4],[110,7,83,5],[110,8,83,6],[110,15,83,13,"error"],[110,20,83,18],[110,22,83,20],[111,8,84,6,"console"],[111,15,84,13],[111,16,84,14,"error"],[111,21,84,19],[111,22,84,20],[111,37,84,35],[111,39,84,37,"error"],[111,44,84,42],[111,45,84,43],[112,6,85,4],[113,4,86,2],[114,2,87,0],[114,3,87,1],[114,4,87,2],[114,5,87,3],[115,0,87,4],[115,3]],"functionMap":{"names":["<global>","create$argument_0","setUser","checkAuth","login","logout"],"mappings":"AAA;8CCyB;WCK,gDD;aEE;GFS;SGE;GHgC;UIE;GJQ;EDC"},"hasCjsExports":false},"type":"js/module"}]}